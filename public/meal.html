<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://kit.fontawesome.com/fca72aa88e.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./css/sidebar.css" />
    <link rel="stylesheet" href="./css/meal.css" />
  </head>

  <body>
     <nav class="navbar">
        <ul class="navbar-nav">
          <li class="logo">
            <a href="/home" class="nav-link">
              <span class="link-text logo-text">Chef's<br>Picks</span>
              <svg viewBox="0 0 448 512">
                <g class="fa-group">
                  <path
                    fill="currentColor"
                    d="M-287.59,116.02c0,0,18.45-11.79,151.2,3.21s159.85,13.34,206.77-7.17s12.56-36.05,105.73-34.3
  c76.84,1.44,140.63,0.99,160.54,2.54c4.23,0.33,6.2,5.55,6.2,5.55s-176.31-0.43-176.11,15.38c0.2,15.81,51.43,10.81,51.43,10.81
  l121.8-1.1l0.32,4.85l-151.16,5.96c0,0-20.89-0.06-21.55,12.65s24.89,11.48,24.89,11.48l126.5-1.28c0,0,11.49-0.05,16.36,0.87
  c13.49,0.25,7.78,4.62,7.78,4.62l-151.72,6.95c0,0-27.96-1.44-26.07,11.4s19.38,9.66,43.24,11.4c11.2,0.82,79.62-4.25,108.28-4.25
  c32.42,0,24.7,4.99,24.7,4.99l-165.12,9.83l-41.35,1.43c0,0-25.84-2.86-37.33-17.21s-25.09-27.29-50.51-28.6
  s-118.46-5.6-160.63,1.91s-123.73,17.57-171.49,4.92c-51.39-1.63-52.14,22.79-89.7,19.84c-37.56-2.96-45.39-19.16-47.14-34.54
  c-1.75-15.38,12.53-45.22,56.46-37.35S-315.01,120.12-287.59,116.02z"
                    class="fa-secondary"
                  ></path>
                  <path
                    fill="currentColor"
                    d="M431.57,206.53l-329.05,5.99c0,0-8.79,6.4-21.52,3.32s-187.71-26.36-262.48-16.64c0,0-5.27,5.65-11.09,1.32
    s-25.47-6.15-29.43,8.15c-3.96,14.3-0.03,47.54,15.15,49.93s15.97,2.84,21.97-4.1c6-6.94,223.63-8.82,268.18-9.44
    c44.56-0.62,80.08,37.07,80.08,37.07S375.12,293.45,431.57,206.53z"
                    class="fa-primary"
                  ></path>
                </g>
              </svg>
            </a>
          </li>

        <li class="nav-item">
          <a href="/meal" class="nav-link meals-link current-link">
            <svg data-icon="hamburger" viewBox="0 0 512 512"
              class="svg-inline--fa fa-hamburger fa-w-16"
            >
              <g class="fa-group">
                <path
                  fill="currentColor"
                  d="M464 256H48a48 48 0 0 0 0 96h416a48 48 0 0 0 0-96zm16 128H32a16 16 0 0 0-16 16v16a64 64 0 0 0 64 64h352a64 64 0 0 0 64-64v-16a16 16 0 0 0-16-16zM58.64 224h394.72c34.57 0 54.62-43.9 34.82-75.88C448 83.2 359.55 32.1 256 32c-103.54.1-192 51.2-232.18 116.11C4 180.09 24.07 224 58.64 224zM384 112a16 16 0 1 1-16 16 16 16 0 0 1 16-16zM256 80a16 16 0 1 1-16 16 16 16 0 0 1 16-16zm-128 32a16 16 0 1 1-16 16 16 16 0 0 1 16-16z"
                  class="fa-secondary"
                ></path>
              </g>
            </svg>
            <span class="link-text">Meals</span>
          </a>
        </li>

        <li class="nav-item">
          <a href="/drink" class="nav-link drinks-link">
            <svg data-icon="coffee" viewBox="-90 0 450 512"
              class="svg-inline--fa fa-coffee fa-w-"
            >
              <g class="fa-group">
                <path
                  fill="currentColor"
                  d="M216 464h-40V346.81c68.47-15.89 118.05-79.91 111.4-154.16l-15.95-178.1C270.71 6.31 263.9 0 255.74 0H32.26c-8.15 0-14.97 6.31-15.7 14.55L.6 192.66C-6.05 266.91 43.53 330.93 112 346.82V464H72c-22.09 0-40 17.91-40 40 0 4.42 3.58 8 8 8h208c4.42 0 8-3.58 8-8 0-22.09-17.91-40-40-40zM61.75 48h164.5l7.17 80H54.58l7.17-80z"
                  class="fa-secondary"
                ></path>
              </g>
            </svg>
            <span class="link-text">Drinks</span>
          </a>
        </li>

        <li class="nav-item">
          <a href="#" class="nav-link collections-link">
            <svg data-icon="plus-square" viewBox="-50 0 512 512"
              class="svg-inline--fa fa-plus-square fa-w-14"
            >
              <g class="fa-group">
                <path
                  fill="currentColor"
                  d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-32 252c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92H92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"
                  class="fa-secondary"
                ></path>
              </g>
            </svg>
            <span class="link-text">Collections</span>
          </a>
        </li>
            <svg></svg>
      </ul>
    </nav>
    
    <div class="wrapper">
      <div class="title">
        Choose a type of meal from the options below
      </div>
    </div>

  <center>
  <div class="container">
    <div class="select-container">
      <select name="meal_type" id="meal_type">
        <option value="null">Type of Meal</option>
        <option value="breakfast">Breakfast</option>
        <option value="side">Side</option>
        <option value="beef">Main Course (Beef)</option>
        <option value="chicken">Main Course (Chicken)</option>
        <option value="seafood">Main Course (Seafood)</option>
        <option value="pasta">Main Course (Pasta)</option>
        <option value="vegetarian">Main Course (Vegetarian)</option>
        <option value="dessert">Dessert</option>				
        <option value="surprise">Surprise Me!</option>
      </select>
    </div>
    <a href="javascript:;" class="button1" onclick="setUpAPI()">Submit</a>
  </div>

  <div class="result-section">
  <div class="card">
      <div class="card-text">
        <h2 id="meal-name"></h2>
      </div>
      <div class="card-image" id="meal-image"></div>
     
	  <div class="card-button">
		<form id="query" method="GET" onSubmit="return validate()" action="http://localhost:8080">
		Your Username:
		<input type="text" id ="username" name="username" placeholder="username"> <br>
		<div id="errorBox"></div>
			
		<input type="text" name ="recipe" id="recipeName" style="display:none">
		<input type="text" name ="imgLink" id="imgLink" style="display:none">


		<input type="submit" value="Save This Recipe">
		</form>
	  </div>
      
    </div>
  </div>
  </center>


    <script language="javascript">	
      function setUpAPI() {

          /* Main Function Processing */
          /* grabbing div & user_bev_type to write text to */
          output_div  = document.getElementById("meal-image");
          output_div2  = document.getElementById("meal-name");
          user_answer = document.getElementById("meal_type").value;
      	  console.log(user_answer);
		  
          if (user_answer == "surprise"){
              var url = "https://www.themealdb.com/api/json/v1/1/random.php";
              console.log("surprise me drink chosen");
          } else if (user_answer == "Type of Meal") {
              /* do nothing, user hasn't made a choice */ 
              return;
          } else {
			  var url = "https://www.themealdb.com/api/json/v1/1/filter.php?c=" + user_answer;
		  }
          
      
          /* creating a new HTTP request */
          request = new XMLHttpRequest();
          request.open("GET", url, true);
          request.onreadystatechange = function() {
              if (request.readyState == 4 && request.status == 200) {
                  objData = request.responseText;
                  objData = JSON.parse(objData);
      
                  meal_num = parseInt(Math.random() * objData.meals.length);
                  
                  output_div.innerHTML = "";
                  output_div2.innerHTML = objData.meals[meal_num].strMeal + "<br>";
                  output_div.innerHTML = "<img src='" + objData.meals[meal_num].strMealThumb + "' style='width:400px'>" + "<br>";
				  
				document.getElementById("recipeName").value = objData.meals[meal_num].strMeal;
				document.getElementById("imgLink").value = objData.meals[meal_num].strMealThumb;


              } else if (request.readyState == 4 && request.status != 200) {
                  alert("Please try again!");
            };
          }
          request.send();
        }
		
		function validate(){
			if(document.getElementById("username").value == "" ){
				document.getElementById("errorBox").innerHTML = "Please Enter a Username";
				return false;
			}
		}
      </script>
  </body>
</html>
